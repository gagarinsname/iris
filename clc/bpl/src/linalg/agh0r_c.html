<html><head>
<meta http-equiv="content-type" content="text/html; charset=windows-1251">

<title>БЧА НИВЦ МГУ. AGH0R_C. Обобщенная проблема собственных значений
       для симметричных и эрмитовых матриц</title>
<link rel="stylesheet" href="agh0r_c_files/sub_dsc.css" type="text/css">
<script charset="utf-8" id="injection_graph_func" src="agh0r_c_files/injection_graph_func.js"></script><script id="_nameHighlight_injection"></script><link class="skype_name_highlight_style" href="agh0r_c_files/injection_nh_graph.css" type="text/css" rel="stylesheet" charset="utf-8" id="_injection_graph_nh_css"><link href="agh0r_c_files/skypeplugin_dropdownmenu.css" type="text/css" rel="stylesheet" charset="utf-8" id="_skypeplugin_dropdownmenu_css"></head><body alink="#aaaaaa" link="#cc6600" vlink="#ee0099">

<table cellpadding="0" cellspacing="0" width="99%">
 <tbody><tr>
  <td style="color: rgb(170, 0, 170);" width="48%">
      Текст подпрограммы и версий <br>
      <a href="http://www.srcc.msu.su/num_anal/lib_na/cat/ag_c/agh0r_c.zip">agh0r_c.zip</a>&nbsp;
  </td><td style="color: rgb(170, 0, 170);" width="52%">
      Тексты тестовых примеров  <br>
      <a href="http://www.srcc.msu.su/num_anal/lib_na/cat/tag_c/tagh0r_c.zip">tagh0r_c.zip</a>&nbsp;
</td></tr></tbody></table>
<hr>
<h3>Подпрограмма:&nbsp; <span> agh0r_c </span></h3>

<h3>Назначение </h3>
<p> Вычисление всех собственных значений и собственных  вектоpов
   в обобщенной проблеме собственных значений 
   ax&nbsp;=&nbsp;<font face="Symbol">l</font>bx
   для вещественных симметричных матриц a и b. </p>

<h3>Математическое описание </h3>
<p> Данная подпрограмма реализyeт aлгоритм вычисления  всех
   собственных  значений  и  собственных  вектоpов  уравнения вида
   Аx&nbsp;=&nbsp;<font face="Symbol">l</font>Bx,
   где  A и B - вещественные  симметрические матрицы и матрица B
   положительно определена. </p>
<p> При помощи разложения Холецкого для матрицы B:&nbsp;
    В&nbsp;=&nbsp;LL<sup>T</sup> исходнoe уpaвнение
    Ax&nbsp;=&nbsp;<font face="Symbol">l</font>Bx приводится к
    стандартному виду Qy&nbsp;=&nbsp;<font face="Symbol">l</font>y, где
    Q&nbsp;=&nbsp;L<sup>&nbsp;-&nbsp;1</sup>AL<sup>&nbsp;-&nbsp;T</sup>,&nbsp;
    y&nbsp;=&nbsp;L<sup>T</sup>x.  Стандартная задача решается путем
    приведения симметрической матрицы  Q к трехдиагональному виду и
    вычисления собственных значений <font face="Symbol">l</font>
    и собственных вектоpов&nbsp; у&nbsp; QL&nbsp;-&nbsp;алгоритмом
    со сдвигом. </p>
<p> Восстановление собственных  вектоpов&nbsp; x&nbsp; исходного уравнения
    Аx&nbsp;=&nbsp;<font face="Symbol">l</font>Bx
    из соответствующих вектоpов&nbsp; у&nbsp; стандартной
    задачи   осуществляется   посредством   решения    уравнения
    L<sup>T</sup>x&nbsp;=&nbsp;y, при этом собственные векторы&nbsp; x&nbsp;
    удовлетворяют условию&nbsp; x<sup>T</sup>Bx&nbsp;=&nbsp;E,
    где E - единичная матрица. </p>
<p> Дж.Х. Уилкинсон, Алгебраическая  проблема  собственных
    значений, "Hаука", M., 1970. </p>

<h3>Использование </h3>
<pre>    int agh0r_c (real *a, real *b, real *v, real *ev, real *rab,
            integer *n, integer *ierr)
</pre>
<pre><h3>   Параметры </h3></pre>
<table cellpadding="6" cellspacing="0" width="99%">
 <tbody><tr>
  <td style="text-align: right;" width="17%">
      a, b - 
  </td><td width="83%">
      вещественные двумерные массивы  размера  n на n,
      содержащие исходные матрицы;
 </td></tr><tr>
  <td style="text-align: right;" width="17%">
      v    -
  </td><td width="83%">
      вещественный двумерный массив размера  n на n, в
      столбцах которого содержатся  вычисленные
      собственные    векторы,   нормированные так, что
      v<sup>t</sup>bv&nbsp;=&nbsp;e;
 </td></tr><tr>
  <td style="text-align: right;" width="17%">
      ev   -
  </td><td width="83%">
      вещественный одномерный массив длины n,
      содержащий вычисленные  собственные значения,
      расположенные в возрастающем порядке;
 </td></tr><tr>
  <td style="text-align: right;" width="17%">
      rab  -
  </td><td width="83%">
      вещественный одномерный массив длины 2 на n,
      используемый как рабочий;
 </td></tr><tr>
  <td style="text-align: right;" width="17%">
      n   -
  </td><td width="83%">
      порядок исходных матриц (тип: целый);
 </td></tr><tr>
  <td style="text-align: right;" width="17%">
      ierr -
  </td><td width="83%">
      целая переменная, служащая для сообщения об
      ошибках, обнаруженных  в ходе работы  подпрограммы;
      при этом значение ierr:
</td></tr></tbody></table>
<table cellpadding="0" cellspacing="0" width="99%">
 <tbody><tr>
  <td style="text-align: right;" width="17%"> &nbsp;
  </td><td width="83%">
   <p> - pавно 7*n+1, если исходная матрица  b не
      является положительно определенной; </p>
      - полагается равным номеpу  собственного
      значения, для вычисления которого потребовалось
      более 30 итераций; при этом вычислены правильно,
      но не упорядочены, собственные  значения с
      индексами 1,&nbsp;2, ...,&nbsp;ierr&nbsp;-&nbsp;1
      и соответствующие собственные векторы. <p></p>
</td></tr></tbody></table>

<pre><h3>   Версии :  <span> нет </span></h3></pre>

<pre><h3>   Вызываемые подпрограммы </h3></pre>
<table cellpadding="6" cellspacing="0" width="99%">
 <tbody><tr>
  <td style="text-align: right;" width="17%">
      utag10_c -
  </td><td width="83%">
      подпрограмма выдачи  диагностических сообщений
      при работе подпрограммы agh0r_c.
</td></tr></tbody></table>

<pre><h3>   Замечания по использованию  </h3></pre>
<table cellpadding="0" cellspacing="0" width="99%">
 <tbody><tr>
  <td width="2%"> &nbsp;
  </td><td width="98%">
   <p> Исходные  матрицы  a и b  можно задавать  в одноименных
       массивах лишь верхними треугольниками. </p>
      Подпрограмма agh0r_c сохраняет строгий  верхний
      треугольник массива  a  и полный верхний треугольник массива  b
      (остальные компоненты массивов  a и b  используются как
      рабочие).
</td></tr></tbody></table>

<h3>Пример использования </h3>
<pre>int main(void)
{
    /* Initialized data */
    static float a[25]   /* was [5][5] */ = { 10.f,0.f,0.f,0.f,0.f,2.f,12.f,
            0.f,0.f,0.f,3.f,1.f,11.f,0.f,0.f,1.f,2.f,1.f,9.f,0.f,1.f,1.f,-1.f,
            1.f,15.f };
    static float b[25]   /* was [5][5] */ = { 12.f,0.f,0.f,0.f,0.f,1.f,14.f,
            0.f,0.f,0.f,-1.f,1.f,16.f,0.f,0.f,2.f,-1.f,-1.f,12.f,0.f,1.f,1.f,
            1.f,-1.f,11.f };

    /* Local variables */
    static int ierr;
    extern int agh0r_c(float *, float *, float *, float *, float *,
                       int *, int *);
    static int i__;
    static float v[25] /* was [5][5] */, ev[5], rab[10];
    static int ie9r;

#define a_ref(a_1,a_2) a[(a_2)*5 + a_1 - 6]
#define b_ref(a_1,a_2) b[(a_2)*5 + a_1 - 6]
#define v_ref(a_1,a_2) v[(a_2)*5 + a_1 - 6]

    for (i__ = 1; i__ &lt;= 5; ++i__) {
         printf("\n %15.7e %15.7e %15.7e %15.7e %15.7e \n",
                a_ref(i__, 1), a_ref(i__, 2), a_ref(i__, 3),
                a_ref(i__, 4), a_ref(i__, 5));
    }
    for (i__ = 1; i__ &lt;= 5; ++i__) {
         printf("\n %15.7e %15.7e %15.7e %15.7e %15.7e \n",
                b_ref(i__, 1), b_ref(i__, 2), b_ref(i__, 3),
                b_ref(i__, 4), b_ref(i__, 5));
    }
    agh0r_c(a, b, v, ev, rab, &amp;c__5, &amp;ie9r);

    for (i__ = 1; i__ &lt;= 5; ++i__) {
         printf("\n %15.7e %15.7e %15.7e %15.7e %15.7e \n",
                a_ref(i__, 1), a_ref(i__, 2), a_ref(i__, 3),
                a_ref(i__, 4), a_ref(i__, 5));
    }
    for (i__ = 1; i__ &lt;= 5; ++i__) {
         printf("\n %15.7e %15.7e %15.7e %15.7e %15.7e \n",
                b_ref(i__, 1), b_ref(i__, 2), b_ref(i__, 3),
                b_ref(i__, 4), b_ref(i__, 5));
    }
    for (i__ = 1; i__ &lt;= 5; ++i__) {
         printf("\n %15.7e \n", ev[i__-1]);
    }
    for (i__ = 1; i__ &lt;= 5; ++i__) {
         printf("\n %15.7e %15.7e %15.7e %15.7e %15.7e \n",
                v_ref(i__, 1), v_ref(i__, 2), v_ref(i__, 3),
                v_ref(i__, 4), v_ref(i__, 5));
    }
    printf("\n %5i \n", ierr);
    return 0;
} /* main */


Результаты:

Собственные значения:

                  | 0.4327872109 |
                  | 0.6636627483 |
      ev  =  | 0.9438590046 |
                  | 1.109284540  |
                  | 1.492353232  |

Собственные векторы:

                 |  0.1345905739   |                 |  0.08291980648  |
                 | -0.061294722    |                  |  0.15314839566  |
      v<sub>1</sub>  =  | -0.157902562     |   ,   v<sub>2</sub>  =  | -0.1186036679    |
                 |  0.109465787     |                 | -0.18281304178  |
                 | -0.04147301179 |                 |  0.003561720367 |

                 | -0.19171003157  |                  |  0.1420119598        |
                 |  0.15899121151  |                   |  0.14241995054      |
      v<sub>3</sub>  =  | -0.07483907094  |    ,   v<sub>4</sub>  =  |  0.12099762300      |    , 
                |  0.13746892946   |                  |  0.125531015188     |
                | -0.088977892351 |                  |  0.00769220728369 |

                | -0.076386717879   |
                |  0.017098001871   |
      v<sub>5</sub>  =  | -0.066664533672  |    .
                |  0.0860480093056 |
                |  0.28943341417     |

      ierr  =  0
</pre>

</body></html>